<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>狗狗 AR 辨識互動</title>
  <script src="https://cdn.jsdelivr.net/npm/aframe@1.5.0/dist/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
  <style>
    #dogVideo, #infoBtn, #dogInfo { display: none; position: absolute; }
    #dogVideo { bottom: 100px; left: 20px; width: 300px; }
    #infoBtn { bottom: 60px; left: 20px; padding: 10px; background:#4CAF50; color:#fff; border:none; border-radius:5px; }
    #dogInfo { bottom: 20px; left:20px; background:rgba(255,255,255,0.8); padding:10px; border-radius:5px; }
  </style>
</head>
<body>
  <video id="dogVideo" controls></video>
  <button id="infoBtn">顯示狗狗資訊</button>
  <div id="dogInfo"></div>

  <a-scene mindar-image="imageTargetSrc: ./targets.mind; filtered: false;"
           vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
    <a-camera position="0 0 0"></a-camera>

    <!-- 預設不顯示，只用來觸發事件 -->
    <a-entity mindar-image-target="targetIndex: 0"></a-entity>
    <a-entity mindar-image-target="targetIndex: 1"></a-entity>
    <a-entity mindar-image-target="targetIndex: 2"></a-entity>
    <a-entity mindar-image-target="targetIndex: 3"></a-entity>
    <a-entity mindar-image-target="targetIndex: 4"></a-entity>
    <a-entity mindar-image-target="targetIndex: 5"></a-entity>
    <a-entity mindar-image-target="targetIndex: 6"></a-entity>
  </a-scene>

  <script>
    const dogData = [
      { key: "husky", name: "哈士奇", desc: "活潑雪橇犬", video:"husky.mp4" },
      { key:"dog2", name:"柴犬", desc:"傲嬌日本犬", video:"dog2.mp4" },
      { key:"dog3", name:"吉娃娃", desc:"迷你玩伴", video:"dog3.mp4" },
      { key:"beagle", name:"比格犬", desc:"嗅覺敏銳", video:"beagle.mp4" },
      { key:"doberman", name:"杜賓狗", desc:"護衛犬", video:"doberman.mp4" },
      { key:"golden", name:"黃金獵犬", desc:"家庭犬", video:"golden.mp4" },
      { key:"mix", name:"迷克斯", desc:"混種犬", video:"mix.mp4" }
    ];

    const video = document.getElementById("dogVideo");
    const btn = document.getElementById("infoBtn");
    const info = document.getElementById("dogInfo");

    document.addEventListener("DOMContentLoaded", () => {
      const scene = document.querySelector("a-scene").components["mindar-image"];
      scene.start();

      dogData.forEach((dog, idx) => {
        scene.el.addEventListener(`targetFoundIndex${idx}`, () => {
          video.src = dog.video; video.style.display = "block";
          btn.style.display = "inline-block";
          btn.onclick = () => {
            info.innerHTML = `<strong>${dog.name}</strong><p>${dog.desc}</p>`;
            info.style.display = "block";
          };
        });
        scene.el.addEventListener(`targetLostIndex${idx}`, () => {
          video.style.display = "none";
          btn.style.display = "none";
          info.style.display = "none";
        });
      });
    });
  </script>
</body>
</html>
